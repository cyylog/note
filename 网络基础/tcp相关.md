#### TCP为啥需要三次握手、四次挥手

* 三次握手的最主要目的是保证连接是双工的，可靠更多的是通过重传机制来保证的。
* 因为连接是全双工的，双方都必须收到对方的FIN包及确认才可关闭。



#### 三次握手

![image-20200517212158598](/Users/drzhang/Library/Application Support/typora-user-images/image-20200517212158598.png)

#####第一次握手：

客户端发送**SYN=1,seq=x**到服务端

##### 第二次握手：

服务端接收到客户端数据，返回**SYN = 1,ACK=1,seq=y,ack=x+1**返回给客户端

##### 第三次握手：

客户端收到服务端的数据，知道服务端能接收到消息，发送**ACK=1,seq=x+1,ack=y+1**给服务端，即建立连接成功





#### TCP为啥需要流量控制

* 由于通讯双方，网速不同。通讯方任一方发送过快都会导致对方消息处理不过来，所以就需要把数据放到缓冲区中
* 如果缓冲区满了，发送方还在疯狂发送，那接收方只能把数据包丢弃。因此我们需要控制发送速率。
* 我们缓冲区剩余大小称之为接收窗口，用变量win表示。如果win=0，则发送方停止发送。



#### TCP为啥需要拥塞控制

* 流量控制与拥塞控制是两个概念，拥塞控制是调解网络的负载
* 接收方网络资源繁忙，因未及时响应ACK导致发送方重传大量数据，这样会导致网络更加拥堵。
* 拥塞控制是动态调整win大小，不只是依赖缓冲区大小确定窗口大小。